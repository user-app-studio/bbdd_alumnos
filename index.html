<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JAM — Gestión de Alumnos</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300..700;1,9..40,300..700&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }
:root {
  --brand: #2E8BC0;
  --brand-dark: #1B6A9C;
  --brand-light: #E8F4FA;
  --brand-pale: #F4FAFD;
  --text: #1a2a3a;
  --text-secondary: #5a6a7a;
  --surface: #ffffff;
  --bg: #f0f4f8;
  --border: #dce4ec;
  --danger: #d94452;
  --danger-light: #fdf0f1;
  --success: #2a9d6a;
  --success-light: #edf9f3;
  --warning: #e8a820;
  --warning-light: #fef9ee;
  --radius: 12px;
  --radius-sm: 8px;
  --shadow: 0 1px 3px rgba(0,0,0,.06), 0 4px 12px rgba(0,0,0,.04);
  --shadow-lg: 0 4px 24px rgba(0,0,0,.08);
  --transition: .2s ease;
  --sidebar-w: 260px;
}
html { font-size: 15px; }
body {
  font-family: 'DM Sans', sans-serif;
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  display: flex;
  overflow-x: hidden;
}
/* ── Sidebar ── */
.sidebar {
  width: var(--sidebar-w);
  min-height: 100vh;
  background: linear-gradient(180deg, #1a3a52 0%, #1B3A50 100%);
  color: #fff;
  display: flex;
  flex-direction: column;
  position: fixed;
  left: 0; top: 0; bottom: 0;
  z-index: 100;
  transition: transform .3s ease;
}
.sidebar-brand {
  padding: 28px 24px 20px;
  display: flex;
  align-items: center;
  gap: 14px;
  border-bottom: 1px solid rgba(255,255,255,.08);
}
.sidebar-brand img { width: 48px; height: 48px; border-radius: 50%; border: 2px solid rgba(255,255,255,.2); }
.sidebar-brand .brand-text { display: flex; flex-direction: column; }
.sidebar-brand .brand-name { font-weight: 700; font-size: 1.5rem; letter-spacing: .02em; line-height: 1; }
.sidebar-brand .brand-sub { font-size: .7rem; opacity: .5; text-transform: uppercase; letter-spacing: .12em; margin-top: 4px; }
.sidebar-nav { padding: 16px 12px; flex: 1; display: flex; flex-direction: column; gap: 2px; }
.nav-item {
  display: flex; align-items: center; gap: 12px;
  padding: 12px 16px;
  border-radius: var(--radius-sm);
  cursor: pointer;
  transition: all var(--transition);
  font-size: .88rem; font-weight: 500;
  color: rgba(255,255,255,.6);
  border: none; background: none; width: 100%; text-align: left;
}
.nav-item:hover { background: rgba(255,255,255,.06); color: rgba(255,255,255,.85); }
.nav-item.active { background: rgba(46,139,192,.25); color: #fff; box-shadow: inset 3px 0 0 var(--brand); }
.nav-item svg { width: 20px; height: 20px; flex-shrink: 0; }
.nav-divider { height: 1px; background: rgba(255,255,255,.06); margin: 12px 16px; }

/* Sync status indicator */
.sync-status {
  display: flex; align-items: center; gap: 8px;
  padding: 10px 16px;
  border-radius: var(--radius-sm);
  font-size: .78rem;
  color: rgba(255,255,255,.5);
  margin: 0 12px;
}
.sync-dot {
  width: 8px; height: 8px; border-radius: 50%;
  background: rgba(255,255,255,.2);
  flex-shrink: 0;
  transition: background .3s ease;
}
.sync-dot.syncing { background: var(--warning); animation: pulse 1s infinite; }
.sync-dot.synced { background: var(--success); }
.sync-dot.error { background: var(--danger); }
.sync-dot.offline { background: rgba(255,255,255,.25); }
@keyframes pulse { 0%,100%{opacity:1} 50%{opacity:.4} }

.sidebar-footer { padding: 16px 20px; border-top: 1px solid rgba(255,255,255,.06); font-size: .72rem; color: rgba(255,255,255,.3); text-align: center; }
/* ── Main ── */
.main { margin-left: var(--sidebar-w); flex: 1; min-height: 100vh; display: flex; flex-direction: column; }
.topbar { background: var(--surface); border-bottom: 1px solid var(--border); padding: 16px 32px; display: flex; align-items: center; justify-content: space-between; gap: 16px; position: sticky; top: 0; z-index: 50; }
.topbar-title { font-weight: 700; font-size: 1.45rem; color: var(--text); }
.topbar-actions { display: flex; gap: 8px; align-items: center; }
.content { padding: 28px 32px; flex: 1; }
/* ── Buttons ── */
.btn { display: inline-flex; align-items: center; gap: 7px; padding: 9px 18px; border-radius: var(--radius-sm); font-family: inherit; font-size: .82rem; font-weight: 600; cursor: pointer; border: 1.5px solid transparent; transition: all var(--transition); white-space: nowrap; }
.btn svg { width: 16px; height: 16px; }
.btn-primary { background: var(--brand); color: #fff; border-color: var(--brand); }
.btn-primary:hover { background: var(--brand-dark); border-color: var(--brand-dark); transform: translateY(-1px); box-shadow: 0 4px 12px rgba(46,139,192,.3); }
.btn-secondary { background: var(--surface); color: var(--text); border-color: var(--border); }
.btn-secondary:hover { border-color: var(--brand); color: var(--brand); }
.btn-danger { background: var(--danger); color: #fff; border-color: var(--danger); }
.btn-danger:hover { background: #c03040; }
.btn-ghost { background: none; color: var(--text-secondary); border: none; padding: 8px 12px; }
.btn-ghost:hover { color: var(--brand); background: var(--brand-light); }
.btn-sm { padding: 6px 12px; font-size: .78rem; }
/* ── Search ── */
.search-box { position: relative; max-width: 360px; flex: 1; }
.search-box input { width: 100%; padding: 9px 14px 9px 38px; border: 1.5px solid var(--border); border-radius: var(--radius-sm); font-family: inherit; font-size: .85rem; background: var(--bg); transition: all var(--transition); color: var(--text); }
.search-box input:focus { outline: none; border-color: var(--brand); background: #fff; box-shadow: 0 0 0 3px rgba(46,139,192,.1); }
.search-box svg { position: absolute; left: 12px; top: 50%; transform: translateY(-50%); width: 16px; height: 16px; color: var(--text-secondary); }
/* ── Cards ── */
.card { background: var(--surface); border-radius: var(--radius); border: 1px solid var(--border); box-shadow: var(--shadow); }
.card-header { padding: 18px 22px; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; }
.card-header h3 { font-size: .95rem; font-weight: 600; }
.card-body { padding: 22px; }
/* ── Student Table ── */
.students-table { width: 100%; border-collapse: collapse; }
.students-table th { text-align: left; padding: 10px 14px; font-size: .72rem; font-weight: 700; text-transform: uppercase; letter-spacing: .08em; color: var(--text-secondary); border-bottom: 2px solid var(--border); }
.students-table td { padding: 12px 14px; font-size: .85rem; border-bottom: 1px solid #f0f2f5; vertical-align: middle; }
.students-table tr:hover td { background: var(--brand-pale); }
.students-table .student-name { font-weight: 600; color: var(--text); }
.students-table .student-email { color: var(--text-secondary); font-size: .78rem; }
/* ── Badges ── */
.badge { display: inline-block; padding: 3px 10px; border-radius: 20px; font-size: .7rem; font-weight: 600; }
.badge-success { background: var(--success-light); color: var(--success); }
.badge-danger { background: var(--danger-light); color: var(--danger); }
.badge-warning { background: var(--warning-light); color: var(--warning); }
.badge-info { background: var(--brand-light); color: var(--brand); }
/* ── Form ── */
.form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 18px; }
.form-group { display: flex; flex-direction: column; gap: 6px; }
.form-group.full { grid-column: 1 / -1; }
.form-label { font-size: .78rem; font-weight: 600; color: var(--text-secondary); }
.form-control { padding: 10px 14px; border: 1.5px solid var(--border); border-radius: var(--radius-sm); font-family: inherit; font-size: .85rem; transition: all var(--transition); background: #fff; color: var(--text); }
.form-control:focus { outline: none; border-color: var(--brand); box-shadow: 0 0 0 3px rgba(46,139,192,.08); }
textarea.form-control { resize: vertical; min-height: 70px; }
select.form-control { cursor: pointer; }
/* ── History Table ── */
.history-table { width: 100%; border-collapse: collapse; margin-top: 8px; }
.history-table th { text-align: left; padding: 8px 12px; font-size: .72rem; font-weight: 700; text-transform: uppercase; letter-spacing: .06em; color: var(--text-secondary); background: var(--bg); border-bottom: 2px solid var(--border); }
.history-table td { padding: 8px 12px; font-size: .82rem; border-bottom: 1px solid #f0f2f5; }
.history-table tr:hover td { background: var(--brand-pale); }
.form-actions { display: flex; gap: 10px; justify-content: flex-end; padding-top: 20px; border-top: 1px solid var(--border); margin-top: 10px; }
/* ── Modal ── */
.modal-overlay { position: fixed; inset: 0; background: rgba(15,25,35,.45); backdrop-filter: blur(4px); z-index: 200; display: flex; align-items: flex-start; justify-content: center; padding: 40px 20px; overflow-y: auto; opacity: 0; pointer-events: none; transition: opacity .25s ease; }
.modal-overlay.active { opacity: 1; pointer-events: all; }
.modal { background: var(--surface); border-radius: var(--radius); width: 100%; max-width: 720px; box-shadow: var(--shadow-lg); transform: translateY(20px); transition: transform .3s ease; }
.modal-overlay.active .modal { transform: translateY(0); }
.modal-header { display: flex; align-items: center; justify-content: space-between; padding: 20px 24px; border-bottom: 1px solid var(--border); }
.modal-header h2 { font-weight: 700; font-size: 1.3rem; }
.modal-body { padding: 24px; max-height: 70vh; overflow-y: auto; }
.modal-close { width: 32px; height: 32px; border: none; background: var(--bg); border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all var(--transition); color: var(--text-secondary); }
.modal-close:hover { background: var(--danger-light); color: var(--danger); }
/* ── Confirm Dialog ── */
.confirm-dialog { max-width: 400px; text-align: center; }
.confirm-dialog .modal-body { padding: 32px 24px; }
.confirm-icon { width: 56px; height: 56px; border-radius: 50%; background: var(--danger-light); color: var(--danger); display: flex; align-items: center; justify-content: center; margin: 0 auto 16px; }
.confirm-icon svg { width: 28px; height: 28px; }
.confirm-title { font-size: 1.05rem; font-weight: 700; margin-bottom: 8px; }
.confirm-text { font-size: .85rem; color: var(--text-secondary); margin-bottom: 24px; line-height: 1.5; }
.confirm-actions { display: flex; gap: 10px; justify-content: center; }
/* ── Stats ── */
.stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 16px; margin-bottom: 24px; }
.stat-card { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius); padding: 20px; box-shadow: var(--shadow); }
.stat-label { font-size: .72rem; font-weight: 600; text-transform: uppercase; letter-spacing: .08em; color: var(--text-secondary); margin-bottom: 8px; }
.stat-value { font-weight: 700; font-size: 2rem; color: var(--text); line-height: 1; }
.stat-sub { font-size: .75rem; color: var(--text-secondary); margin-top: 4px; }
.charts-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
.chart-card { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius); padding: 20px; box-shadow: var(--shadow); }
.chart-card h4 { font-size: .82rem; font-weight: 700; color: var(--text); margin-bottom: 16px; }
.chart-container { position: relative; height: 260px; }
.topic-list { list-style: none; display: flex; flex-direction: column; gap: 6px; }
.topic-item { display: flex; align-items: center; justify-content: space-between; padding: 8px 12px; background: var(--bg); border-radius: var(--radius-sm); font-size: .82rem; }
.topic-count { background: var(--brand-light); color: var(--brand-dark); padding: 2px 10px; border-radius: 20px; font-size: .72rem; font-weight: 700; }
/* ── Profile ── */
.profile-header { display: flex; align-items: center; gap: 20px; margin-bottom: 24px; padding-bottom: 20px; border-bottom: 1px solid var(--border); }
.profile-avatar { width: 64px; height: 64px; border-radius: 50%; background: var(--brand); color: #fff; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1.5rem; flex-shrink: 0; }
.profile-info h2 { font-weight: 700; font-size: 1.4rem; margin-bottom: 4px; }
.profile-meta { display: flex; gap: 16px; flex-wrap: wrap; font-size: .8rem; color: var(--text-secondary); }
.profile-meta span { display: flex; align-items: center; gap: 4px; }
.profile-section { margin-bottom: 20px; }
.profile-section h4 { font-size: .78rem; font-weight: 700; text-transform: uppercase; letter-spacing: .08em; color: var(--text-secondary); margin-bottom: 10px; padding-bottom: 6px; border-bottom: 1px solid var(--border); }
.profile-section p { font-size: .88rem; line-height: 1.6; white-space: pre-wrap; }
.profile-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
/* ── Empty State ── */
.empty-state { text-align: center; padding: 60px 20px; }
.empty-state svg { width: 64px; height: 64px; color: var(--border); margin-bottom: 16px; }
.empty-state h3 { font-size: 1.1rem; margin-bottom: 8px; color: var(--text); }
.empty-state p { font-size: .85rem; color: var(--text-secondary); margin-bottom: 20px; }
/* ── Mobile ── */
.hamburger { display: none; background: none; border: none; cursor: pointer; padding: 8px; color: var(--text); }
.hamburger svg { width: 24px; height: 24px; }
.sidebar-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,.4); z-index: 99; }
/* ── Views ── */
.view { display: none; }
.view.active { display: block; }
/* ── Print ── */
@media print {
  .sidebar, .topbar, .btn, .modal-overlay, .hamburger, .sidebar-overlay { display: none !important; }
  .main { margin-left: 0 !important; }
  .content { padding: 0 !important; }
  .card { box-shadow: none; border: 1px solid #ddd; }
  .print-header { display: flex !important; align-items: center; gap: 16px; margin-bottom: 24px; padding-bottom: 16px; border-bottom: 2px solid var(--brand); }
  .print-header img { width: 48px; height: 48px; }
  .print-header h1 { font-weight: 700; font-size: 1.4rem; }
}
.print-header { display: none; }
/* ── Responsive ── */
@media (max-width: 900px) {
  .sidebar { transform: translateX(-100%); }
  .sidebar.open { transform: translateX(0); }
  .sidebar-overlay.open { display: block; }
  .hamburger { display: block; }
  .main { margin-left: 0; }
  .topbar { padding: 12px 16px; }
  .content { padding: 16px; }
  .form-grid { grid-template-columns: 1fr; }
  .charts-grid { grid-template-columns: 1fr; }
  .profile-grid { grid-template-columns: 1fr; }
  .stats-grid { grid-template-columns: 1fr 1fr; }
}
@media (max-width: 500px) { .stats-grid { grid-template-columns: 1fr; } }
/* ── Animations ── */
@keyframes fadeUp { from { opacity:0; transform:translateY(12px); } to { opacity:1; transform:translateY(0); } }
.fade-up { animation: fadeUp .4s ease both; }
.notification {
  position: fixed; bottom: 24px; right: 24px;
  background: var(--text); color: #fff;
  padding: 12px 20px; border-radius: var(--radius-sm);
  font-size: .84rem; font-weight: 500;
  box-shadow: var(--shadow-lg); z-index: 300;
  transform: translateY(80px); opacity: 0;
  transition: all .3s ease;
  max-width: 320px;
}
.notification.show { transform: translateY(0); opacity: 1; }
.notification.success { background: var(--success); }
.notification.error { background: var(--danger); }
.notification.warning { background: #b37a00; }
</style>
</head>
<body>

<div class="sidebar-overlay" id="sidebarOverlay"></div>

<aside class="sidebar" id="sidebar">
  <div class="sidebar-brand">
    <img id="logoImg" src="" alt="JAM Logo">
    <div class="brand-text">
      <span class="brand-name">JAM</span>
      <span class="brand-sub">Gestión de Alumnos</span>
    </div>
  </div>
  <nav class="sidebar-nav">
    <button class="nav-item active" data-view="students" onclick="switchView('students')">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
      Alumnos
    </button>
    <button class="nav-item" data-view="add" onclick="switchView('add')">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="8.5" cy="7" r="4"/><line x1="20" y1="8" x2="20" y2="14"/><line x1="23" y1="11" x2="17" y2="11"/></svg>
      Nuevo Alumno
    </button>
    <button class="nav-item" data-view="stats" onclick="switchView('stats')">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg>
      Estadísticas
    </button>
    <div class="nav-divider"></div>
    <button class="nav-item" onclick="exportToExcel()">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><line x1="3" y1="9" x2="21" y2="9"/><line x1="3" y1="15" x2="21" y2="15"/><line x1="9" y1="3" x2="9" y2="21"/><line x1="15" y1="3" x2="15" y2="21"/></svg>
      Exportar Excel (backup)
    </button>
    <button class="nav-item" onclick="manualSync()">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
      Sincronizar ahora
    </button>
    <div class="nav-divider"></div>
    <button class="nav-item" onclick="showGitHubConfig()">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/></svg>
      Configurar GitHub
    </button>
  </nav>

  <!-- Sync Status -->
  <div class="sync-status" id="syncStatus">
    <div class="sync-dot offline" id="syncDot"></div>
    <span id="syncText">Sin configurar</span>
  </div>

  <div class="sidebar-footer">JLMF12 & JAM STUDIO &copy; 2026</div>
</aside>

<div class="main">
  <header class="topbar">
    <div style="display:flex;align-items:center;gap:12px;">
      <button class="hamburger" onclick="toggleSidebar()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
      </button>
      <h1 class="topbar-title" id="viewTitle">Alumnos</h1>
    </div>
    <div class="topbar-actions" id="topbarActions">
      <div class="search-box">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
        <input type="text" id="searchInput" placeholder="Buscar alumnos..." oninput="renderStudents()">
      </div>
      <button class="btn btn-primary" onclick="switchView('add')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
        Añadir
      </button>
    </div>
  </header>

  <div class="content">
    <div class="view active" id="view-students">
      <div class="card"><div id="studentsTableWrapper"></div></div>
    </div>

    <div class="view" id="view-add">
      <div class="card">
        <div class="card-header"><h3 id="formTitle">Nuevo Alumno</h3></div>
        <div class="card-body">
          <form id="studentForm" onsubmit="saveStudent(event)">
            <input type="hidden" id="editId">
            <div class="form-grid">
              <div class="form-group">
                <label class="form-label">Nombre completo *</label>
                <input type="text" class="form-control" id="f_nombre" required>
              </div>
              <div class="form-group">
                <label class="form-label">Teléfono</label>
                <input type="tel" class="form-control" id="f_telefono">
              </div>
              <div class="form-group">
                <label class="form-label">Correo electrónico</label>
                <input type="email" class="form-control" id="f_correo">
              </div>
              <div class="form-group">
                <label class="form-label">Dirección</label>
                <input type="text" class="form-control" id="f_direccion">
              </div>
              <div class="form-group">
                <label class="form-label">Sexo</label>
                <select class="form-control" id="f_sexo">
                  <option value="">— Seleccionar —</option>
                  <option value="Masculino">Masculino</option>
                  <option value="Femenino">Femenino</option>
                  <option value="Otro">Otro</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">Edad</label>
                <input type="number" class="form-control" id="f_edad" min="1" max="120">
              </div>
              <div class="form-group">
                <label class="form-label">Fecha última clase</label>
                <input type="date" class="form-control" id="f_fechaUltimaClase">
              </div>
              <div class="form-group">
                <label class="form-label">Duración última clase</label>
                <select class="form-control" id="f_duracion">
                  <option value="">— Seleccionar —</option>
                  <option value="30min">30 minutos</option>
                  <option value="45min">45 minutos</option>
                  <option value="1h">1 hora</option>
                  <option value="1.5h">1 hora y media</option>
                  <option value="2h">2 horas</option>
                  <option value="2.5h">2 horas y media</option>
                  <option value="3h">3 horas</option>
                  <option value="3.5h">3 horas y media</option>
                  <option value="4h">4 horas</option>
                  <option value="4.5h">4 horas y media</option>
                  <option value="5h">5 horas</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">¿Paga bien?</label>
                <select class="form-control" id="f_pago">
                  <option value="">— Seleccionar —</option>
                  <option value="Sí">Sí</option>
                  <option value="No">No</option>
                  <option value="A veces">A veces</option>
                  <option value="Se lo hago gratis">Se lo hago gratis</option>
                </select>
              </div>
              <div class="form-group full">
                <label class="form-label">Temática tratada</label>
                <textarea class="form-control" id="f_tematica" rows="2" placeholder="Ej: Word, Excel, navegación web, correo electrónico..."></textarea>
              </div>
              <div class="form-group">
                <label class="form-label">Lo que sabe hacer</label>
                <textarea class="form-control" id="f_sabe" rows="3" placeholder="Habilidades que ya domina..."></textarea>
              </div>
              <div class="form-group">
                <label class="form-label">Lo que no sabe hacer</label>
                <textarea class="form-control" id="f_nosabe" rows="3" placeholder="Áreas donde necesita mejorar..."></textarea>
              </div>
              <div class="form-group full">
                <label class="form-label">Necesidades especiales</label>
                <textarea class="form-control" id="f_necesidades" rows="2" placeholder="Necesidades particulares del alumno..."></textarea>
              </div>
              <div class="form-group full">
                <label class="form-label">Personalidad del alumno</label>
                <textarea class="form-control" id="f_personalidad" rows="2" placeholder="Amigable, reservado, paciente, nervioso..."></textarea>
              </div>
              <div class="form-group full">
                <label class="form-label">Sugerencias para ayudarle mejor</label>
                <textarea class="form-control" id="f_sugerencias" rows="2" placeholder="Medidas recomendadas, enfoques pedagógicos..."></textarea>
              </div>
              <div class="form-group">
                <label class="form-label">¿Recomendable seguir con él?</label>
                <select class="form-control" id="f_aconsejable">
                  <option value="">— Seleccionar —</option>
                  <option value="Sí">Sí</option>
                  <option value="No">No</option>
                  <option value="En evaluación">En evaluación</option>
                </select>
              </div>
              <div class="form-group">&nbsp;</div>
              <div class="form-group full">
                <label class="form-label">Notas adicionales</label>
                <textarea class="form-control" id="f_notas" rows="3" placeholder="Cualquier información relevante adicional..."></textarea>
              </div>
            </div>
            <div class="form-actions">
              <button type="button" class="btn btn-secondary" onclick="cancelForm()">Cancelar</button>
              <button type="submit" class="btn btn-primary" id="formSubmitBtn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                Guardar Alumno
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <div class="view" id="view-profile">
      <div class="print-header" id="printHeader">
        <img id="printLogo" src="" alt="JAM">
        <div><h1>JAM Informática — Ficha de Alumno</h1></div>
      </div>
      <div id="profileContent"></div>
    </div>

    <div class="view" id="view-stats">
      <div id="statsContent"></div>
    </div>
  </div>
</div>

<!-- GitHub Config Modal -->
<div class="modal-overlay" id="githubOverlay">
  <div class="modal" style="max-width:520px;">
    <div class="modal-header">
      <h2>Configurar GitHub</h2>
      <button class="modal-close" onclick="closeGitHub()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
      </button>
    </div>
    <div class="modal-body">
      <div style="background:var(--brand-light);border-radius:var(--radius-sm);padding:12px 16px;margin-bottom:18px;font-size:.82rem;color:var(--brand-dark);line-height:1.5;">
        <strong>Auto-sincronización activa:</strong> Al guardar la configuración, los datos se cargarán automáticamente desde GitHub al abrir la app, y se guardarán en GitHub al añadir, editar o eliminar alumnos.
      </div>
      <div style="display:flex;flex-direction:column;gap:14px;">
        <div class="form-group">
          <label class="form-label">Token de acceso personal (PAT)</label>
          <input type="password" class="form-control" id="gh_token" placeholder="ghp_xxxxxxxxxxxx">
          <span style="font-size:.7rem;color:var(--text-secondary);">GitHub → Settings → Developer settings → Personal access tokens. Necesita permisos de "repo".</span>
        </div>
        <div class="form-group">
          <label class="form-label">Repositorio (usuario/repo)</label>
          <input type="text" class="form-control" id="gh_repo" placeholder="usuario/mi-base-datos">
        </div>
        <div class="form-group">
          <label class="form-label">Nombre del archivo JSON de datos</label>
          <input type="text" class="form-control" id="gh_filename" value="jam_alumnos.json">
          <span style="font-size:.7rem;color:var(--text-secondary);">Se usará JSON para sincronización (más eficiente). El Excel es solo para backup local.</span>
        </div>
        <div class="form-group">
          <label class="form-label">Rama</label>
          <input type="text" class="form-control" id="gh_branch" value="main">
        </div>
        <div class="form-actions" style="border-top:none;margin-top:0;padding-top:0;">
          <button class="btn btn-secondary" onclick="closeGitHub()">Cancelar</button>
          <button class="btn btn-primary" onclick="saveGitHubConfig()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><polyline points="20 6 9 17 4 12"/></svg>
            Guardar y conectar
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Confirm Modal -->
<div class="modal-overlay" id="confirmOverlay">
  <div class="modal confirm-dialog">
    <div class="modal-body">
      <div class="confirm-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></svg>
      </div>
      <div class="confirm-title" id="confirmTitle">¿Eliminar alumno?</div>
      <div class="confirm-text" id="confirmText">Esta acción no se puede deshacer.</div>
      <div class="confirm-actions">
        <button class="btn btn-secondary" onclick="closeConfirm()">Cancelar</button>
        <button class="btn btn-danger" id="confirmBtn">Eliminar</button>
      </div>
    </div>
  </div>
</div>

<div class="notification" id="notification"></div>

<script>
// ═══════════════════════════════════════════
// DATABASE
// ═══════════════════════════════════════════
const STORAGE_KEY = 'jam_students_db';
let db = [];
let chartInstances = {};

function loadDB() {
  try {
    const raw = localStorage.getItem(STORAGE_KEY);
    db = raw ? JSON.parse(raw) : [];
  } catch(e) { db = []; }
}
function saveDB() {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(db));
}
function generateId() {
  return Date.now().toString(36) + Math.random().toString(36).substr(2, 6);
}

// ═══════════════════════════════════════════
// GITHUB CONFIG
// ═══════════════════════════════════════════
const GH_CONFIG_KEY = 'jam_github_config';

function loadGitHubConfig() {
  try { return JSON.parse(localStorage.getItem(GH_CONFIG_KEY)) || {}; }
  catch(e) { return {}; }
}

function isGitHubConfigured() {
  const cfg = loadGitHubConfig();
  return !!(cfg.token && cfg.repo);
}

function showGitHubConfig() {
  const cfg = loadGitHubConfig();
  document.getElementById('gh_token').value = cfg.token || '';
  document.getElementById('gh_repo').value = cfg.repo || '';
  document.getElementById('gh_filename').value = cfg.filename || 'jam_alumnos.json';
  document.getElementById('gh_branch').value = cfg.branch || 'main';
  document.getElementById('githubOverlay').classList.add('active');
  closeSidebar();
}
function closeGitHub() {
  document.getElementById('githubOverlay').classList.remove('active');
}
async function saveGitHubConfig() {
  const cfg = {
    token: document.getElementById('gh_token').value.trim(),
    repo: document.getElementById('gh_repo').value.trim(),
    filename: document.getElementById('gh_filename').value.trim() || 'jam_alumnos.json',
    branch: document.getElementById('gh_branch').value.trim() || 'main'
  };
  if (!cfg.token || !cfg.repo) { notify('Token y repositorio son obligatorios', 'error'); return; }
  localStorage.setItem(GH_CONFIG_KEY, JSON.stringify(cfg));
  closeGitHub();
  notify('Configuración guardada. Cargando datos de GitHub...', 'warning');
  await pullFromGitHub(true);
}

// ═══════════════════════════════════════════
// SYNC STATUS UI
// ═══════════════════════════════════════════
function setSyncStatus(state, text) {
  const dot = document.getElementById('syncDot');
  const txt = document.getElementById('syncText');
  dot.className = 'sync-dot ' + state;
  txt.textContent = text;
}

// ═══════════════════════════════════════════
// GITHUB PUSH (guardar en GitHub)
// ═══════════════════════════════════════════
async function pushToGitHub() {
  const cfg = loadGitHubConfig();
  if (!cfg.token || !cfg.repo) return; // silencioso si no configurado

  setSyncStatus('syncing', 'Guardando...');
  try {
    const content = btoa(unescape(encodeURIComponent(JSON.stringify(db, null, 2))));
    const apiBase = `https://api.github.com/repos/${cfg.repo}/contents/${cfg.filename}`;

    // Obtener SHA del archivo si existe
    let sha = null;
    try {
      const existing = await fetch(`${apiBase}?ref=${cfg.branch}`, {
        headers: { 'Authorization': `token ${cfg.token}`, 'Accept': 'application/vnd.github.v3+json' }
      });
      if (existing.ok) { const data = await existing.json(); sha = data.sha; }
    } catch(e) {}

    const body = {
      message: `Actualizar alumnos - ${new Date().toLocaleString('es-ES')}`,
      content,
      branch: cfg.branch
    };
    if (sha) body.sha = sha;

    const response = await fetch(apiBase, {
      method: 'PUT',
      headers: {
        'Authorization': `token ${cfg.token}`,
        'Accept': 'application/vnd.github.v3+json',
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(body)
    });

    if (response.ok) {
      const now = new Date().toLocaleTimeString('es-ES', {hour:'2-digit', minute:'2-digit'});
      setSyncStatus('synced', 'Sync ' + now);
    } else {
      const err = await response.json();
      setSyncStatus('error', 'Error al guardar');
      notify('Error GitHub: ' + (err.message || 'No se pudo guardar'), 'error');
    }
  } catch(e) {
    setSyncStatus('error', 'Sin conexión');
    notify('Sin conexión con GitHub', 'error');
  }
}

// ═══════════════════════════════════════════
// GITHUB PULL (cargar desde GitHub)
// ═══════════════════════════════════════════
async function pullFromGitHub(silent = false) {
  const cfg = loadGitHubConfig();
  if (!cfg.token || !cfg.repo) {
    setSyncStatus('offline', 'Sin configurar');
    return;
  }

  setSyncStatus('syncing', 'Cargando...');
  try {
    const apiBase = `https://api.github.com/repos/${cfg.repo}/contents/${cfg.filename}`;
    const response = await fetch(`${apiBase}?ref=${cfg.branch}&t=${Date.now()}`, {
      headers: { 'Authorization': `token ${cfg.token}`, 'Accept': 'application/vnd.github.v3+json' }
    });

    if (response.status === 404) {
      // Archivo no existe aún en GitHub → subir los datos locales
      setSyncStatus('synced', 'Listo (nuevo)');
      if (!silent) notify('Archivo nuevo en GitHub. Se subirán los datos locales.', 'warning');
      await pushToGitHub();
      return;
    }

    if (!response.ok) {
      let errMsg = response.status + ' ' + response.statusText;
      try { const err = await response.json(); errMsg += ': ' + (err.message || ''); } catch(e) {}
      setSyncStatus('error', 'Error ' + response.status);
      notify('GitHub ' + errMsg + ' | URL: ' + apiBase, 'error');
      console.error('GitHub error:', response.status, apiBase);
      return;
    }

    const fileData = await response.json();
    const decoded = decodeURIComponent(escape(atob(fileData.content.replace(/\n/g, ''))));
    const imported = JSON.parse(decoded);

    if (!Array.isArray(imported)) throw new Error('Formato inválido');

    db = imported;
    saveDB();
    renderStudents();

    const now = new Date().toLocaleTimeString('es-ES', {hour:'2-digit', minute:'2-digit'});
    setSyncStatus('synced', 'Sync ' + now);
    if (!silent) notify(`${db.length} alumnos cargados desde GitHub`, 'success');

  } catch(e) {
    setSyncStatus('error', 'Error de sync');
    if (!silent) notify('Error: ' + (e.message || String(e)), 'error');
    console.error(e);
  }
}

// Sincronización manual (botón)
async function manualSync() {
  closeSidebar();
  notify('Sincronizando con GitHub...', 'warning');
  await pullFromGitHub(false);
}

// ═══════════════════════════════════════════
// NAVIGATION
// ═══════════════════════════════════════════
const viewTitles = { students: 'Alumnos', add: 'Nuevo Alumno', stats: 'Estadísticas', profile: 'Ficha del Alumno' };

function switchView(name) {
  document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
  document.getElementById('view-' + name).classList.add('active');
  document.querySelectorAll('.nav-item[data-view]').forEach(n => n.classList.remove('active'));
  const navBtn = document.querySelector(`.nav-item[data-view="${name}"]`);
  if (navBtn) navBtn.classList.add('active');
  document.getElementById('viewTitle').textContent = viewTitles[name] || '';
  const ta = document.getElementById('topbarActions');
  ta.style.display = name === 'students' ? 'flex' : 'none';
  if (name === 'students') renderStudents();
  if (name === 'stats') renderStats();
  if (name === 'add' && !document.getElementById('editId').value) {
    document.getElementById('formTitle').textContent = 'Nuevo Alumno';
    document.getElementById('formSubmitBtn').innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg> Guardar Alumno';
  }
  closeSidebar();
}

function toggleSidebar() {
  document.getElementById('sidebar').classList.toggle('open');
  document.getElementById('sidebarOverlay').classList.toggle('open');
}
function closeSidebar() {
  document.getElementById('sidebar').classList.remove('open');
  document.getElementById('sidebarOverlay').classList.remove('open');
}
document.getElementById('sidebarOverlay').addEventListener('click', closeSidebar);

// ═══════════════════════════════════════════
// NOTIFICATIONS
// ═══════════════════════════════════════════
function notify(msg, type = '') {
  const el = document.getElementById('notification');
  el.textContent = msg;
  el.className = 'notification' + (type ? ' ' + type : '');
  el.classList.add('show');
  setTimeout(() => el.classList.remove('show'), 3000);
}

// ═══════════════════════════════════════════
// CONFIRM DIALOG
// ═══════════════════════════════════════════
function showConfirm(title, text, onConfirm, btnText = 'Eliminar') {
  document.getElementById('confirmTitle').textContent = title;
  document.getElementById('confirmText').textContent = text;
  const btn = document.getElementById('confirmBtn');
  btn.textContent = btnText;
  btn.onclick = () => { closeConfirm(); onConfirm(); };
  document.getElementById('confirmOverlay').classList.add('active');
}
function closeConfirm() {
  document.getElementById('confirmOverlay').classList.remove('active');
}

// ═══════════════════════════════════════════
// RENDER STUDENTS LIST
// ═══════════════════════════════════════════
function renderStudents() {
  const query = document.getElementById('searchInput').value.toLowerCase().trim();
  let filtered = db;
  if (query) {
    filtered = db.filter(s => {
      const haystack = [s.nombre, s.telefono, s.correo, s.direccion, s.sexo, s.tematica, s.sabe, s.nosabe, s.necesidades, s.personalidad, s.sugerencias, s.notas, s.aconsejable, s.pago, s.fechaUltimaClase || '', s.duracion || ''].join(' ').toLowerCase();
      return haystack.includes(query);
    });
  }

  const wrapper = document.getElementById('studentsTableWrapper');
  if (filtered.length === 0) {
    wrapper.innerHTML = `<div class="empty-state">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
      <h3>${query ? 'Sin resultados' : 'No hay alumnos registrados'}</h3>
      <p>${query ? 'Prueba con otro término de búsqueda.' : 'Añade tu primer alumno para empezar.'}</p>
      ${!query ? '<button class="btn btn-primary" onclick="switchView(\'add\')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg> Añadir Alumno</button>' : ''}
    </div>`;
    return;
  }

  let html = '<table class="students-table"><thead><tr><th>Alumno</th><th>Contacto</th><th>Última clase</th><th>Duración</th><th>Pago</th><th>Seguir</th><th style="text-align:right">Acciones</th></tr></thead><tbody>';
  filtered.forEach(s => {
    const initials = s.nombre.split(' ').map(w => w[0]).join('').substring(0, 2).toUpperCase();
    const payBadge = s.pago === 'Sí' ? 'badge-success' : s.pago === 'No' ? 'badge-danger' : s.pago === 'Se lo hago gratis' ? 'badge-info' : s.pago === 'A veces' ? 'badge-warning' : 'badge-info';
    const advBadge = s.aconsejable === 'Sí' ? 'badge-success' : s.aconsejable === 'No' ? 'badge-danger' : s.aconsejable === 'En evaluación' ? 'badge-warning' : 'badge-info';
    const fechaClase = s.fechaUltimaClase ? new Date(s.fechaUltimaClase + 'T00:00:00').toLocaleDateString('es-ES') : '—';
    html += `<tr class="fade-up">
      <td><div style="display:flex;align-items:center;gap:10px;">
        <div style="width:36px;height:36px;border-radius:50%;background:var(--brand);color:#fff;display:flex;align-items:center;justify-content:center;font-size:.72rem;font-weight:700;flex-shrink:0;">${initials}</div>
        <div><div class="student-name">${esc(s.nombre)}</div>
        <div class="student-email">${s.edad ? s.edad + ' años' : ''}${s.edad && s.sexo ? ' · ' : ''}${esc(s.sexo || '')}</div></div>
      </div></td>
      <td><div style="font-size:.82rem;">${esc(s.telefono || '—')}</div><div class="student-email">${esc(s.correo || '—')}</div></td>
      <td><span style="font-size:.82rem;">${esc(fechaClase)}</span></td>
      <td><span style="font-size:.82rem;">${esc(s.duracion || '—')}</span></td>
      <td><span class="badge ${payBadge}">${esc(s.pago || '—')}</span></td>
      <td><span class="badge ${advBadge}">${esc(s.aconsejable || '—')}</span></td>
      <td style="text-align:right;white-space:nowrap;">
        <button class="btn btn-ghost btn-sm" onclick="viewProfile('${s.id}')" title="Ver ficha"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg></button>
        <button class="btn btn-ghost btn-sm" onclick="editStudent('${s.id}')" title="Editar"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg></button>
        <button class="btn btn-ghost btn-sm" onclick="confirmDelete('${s.id}')" title="Eliminar" style="color:var(--danger);"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><path d="M3 6h18"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg></button>
      </td></tr>`;
  });
  html += '</tbody></table>';
  wrapper.innerHTML = html;
}

function esc(str) {
  const d = document.createElement('div');
  d.textContent = str || '';
  return d.innerHTML;
}

// ═══════════════════════════════════════════
// FORM: SAVE STUDENT (con auto-push)
// ═══════════════════════════════════════════
async function saveStudent(e) {
  e.preventDefault();
  const editId = document.getElementById('editId').value;
  const fechaUltimaClase = document.getElementById('f_fechaUltimaClase').value;
  const duracionUltimaClase = document.getElementById('f_duracion').value;

  let historialClases = [];
  if (editId) {
    const existing = db.find(s => s.id === editId);
    if (existing) historialClases = existing.historialClases || [];
  }
  if (fechaUltimaClase && duracionUltimaClase) {
    const existingIdx = historialClases.findIndex(h => h.fecha === fechaUltimaClase);
    if (existingIdx !== -1) { historialClases[existingIdx].duracion = duracionUltimaClase; }
    else { historialClases.push({ fecha: fechaUltimaClase, duracion: duracionUltimaClase }); }
    historialClases.sort((a, b) => b.fecha.localeCompare(a.fecha));
  }

  const student = {
    id: editId || generateId(),
    nombre: document.getElementById('f_nombre').value.trim(),
    telefono: document.getElementById('f_telefono').value.trim(),
    correo: document.getElementById('f_correo').value.trim(),
    direccion: document.getElementById('f_direccion').value.trim(),
    sexo: document.getElementById('f_sexo').value,
    edad: document.getElementById('f_edad').value ? parseInt(document.getElementById('f_edad').value) : null,
    fechaUltimaClase,
    duracion: duracionUltimaClase,
    historialClases,
    tematica: document.getElementById('f_tematica').value.trim(),
    sabe: document.getElementById('f_sabe').value.trim(),
    nosabe: document.getElementById('f_nosabe').value.trim(),
    necesidades: document.getElementById('f_necesidades').value.trim(),
    personalidad: document.getElementById('f_personalidad').value.trim(),
    sugerencias: document.getElementById('f_sugerencias').value.trim(),
    aconsejable: document.getElementById('f_aconsejable').value,
    pago: document.getElementById('f_pago').value,
    notas: document.getElementById('f_notas').value.trim(),
    fechaRegistro: editId ? (db.find(s => s.id === editId)?.fechaRegistro || new Date().toISOString()) : new Date().toISOString(),
    ultimaActualizacion: new Date().toISOString()
  };

  if (editId) {
    const idx = db.findIndex(s => s.id === editId);
    if (idx !== -1) db[idx] = student;
    notify('Alumno actualizado. Guardando en GitHub...');
  } else {
    db.push(student);
    notify('Alumno añadido. Guardando en GitHub...');
  }

  saveDB();
  resetForm();
  switchView('students');
  await pushToGitHub();
}

function resetForm() {
  document.getElementById('studentForm').reset();
  document.getElementById('editId').value = '';
  document.getElementById('formTitle').textContent = 'Nuevo Alumno';
}
function cancelForm() { resetForm(); switchView('students'); }

// ═══════════════════════════════════════════
// EDIT STUDENT
// ═══════════════════════════════════════════
function editStudent(id) {
  const s = db.find(st => st.id === id);
  if (!s) return;
  document.getElementById('editId').value = s.id;
  document.getElementById('f_nombre').value = s.nombre || '';
  document.getElementById('f_telefono').value = s.telefono || '';
  document.getElementById('f_correo').value = s.correo || '';
  document.getElementById('f_direccion').value = s.direccion || '';
  document.getElementById('f_sexo').value = s.sexo || '';
  document.getElementById('f_edad').value = s.edad || '';
  document.getElementById('f_fechaUltimaClase').value = s.fechaUltimaClase || '';
  document.getElementById('f_duracion').value = s.duracion || '';
  document.getElementById('f_tematica').value = s.tematica || '';
  document.getElementById('f_sabe').value = s.sabe || '';
  document.getElementById('f_nosabe').value = s.nosabe || '';
  document.getElementById('f_necesidades').value = s.necesidades || '';
  document.getElementById('f_personalidad').value = s.personalidad || '';
  document.getElementById('f_sugerencias').value = s.sugerencias || '';
  document.getElementById('f_aconsejable').value = s.aconsejable || '';
  document.getElementById('f_pago').value = s.pago || '';
  document.getElementById('f_notas').value = s.notas || '';
  document.getElementById('formTitle').textContent = 'Editar Alumno';
  document.getElementById('formSubmitBtn').innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg> Actualizar Alumno';
  switchView('add');
}

// ═══════════════════════════════════════════
// DELETE STUDENT (con auto-push)
// ═══════════════════════════════════════════
function confirmDelete(id) {
  const s = db.find(st => st.id === id);
  if (!s) return;
  showConfirm(
    '¿Eliminar alumno?',
    `Se eliminarán todos los datos de "${s.nombre}". Esta acción no se puede deshacer.`,
    async () => {
      db = db.filter(st => st.id !== id);
      saveDB();
      renderStudents();
      notify('Alumno eliminado. Guardando en GitHub...');
      await pushToGitHub();
    }
  );
}

// ═══════════════════════════════════════════
// VIEW PROFILE
// ═══════════════════════════════════════════
function viewProfile(id) {
  const s = db.find(st => st.id === id);
  if (!s) return;
  const initials = s.nombre.split(' ').map(w => w[0]).join('').substring(0, 2).toUpperCase();
  const regDate = s.fechaRegistro ? new Date(s.fechaRegistro).toLocaleDateString('es-ES') : '—';
  const updDate = s.ultimaActualizacion ? new Date(s.ultimaActualizacion).toLocaleDateString('es-ES') : '—';
  const payBadge = s.pago === 'Sí' ? 'badge-success' : s.pago === 'No' ? 'badge-danger' : s.pago === 'Se lo hago gratis' ? 'badge-info' : 'badge-warning';
  const advBadge = s.aconsejable === 'Sí' ? 'badge-success' : s.aconsejable === 'No' ? 'badge-danger' : 'badge-warning';

  const historial = s.historialClases || [];
  let historialHtml = '';
  if (historial.length > 0) {
    historialHtml = `<div class="profile-section"><h4>Historial de Clases (${historial.length} sesiones)</h4>
      <table class="history-table"><thead><tr><th>Fecha</th><th>Duración</th></tr></thead><tbody>
        ${historial.map(h => `<tr><td>${new Date(h.fecha + 'T00:00:00').toLocaleDateString('es-ES')}</td><td>${esc(h.duracion)}</td></tr>`).join('')}
      </tbody></table></div>`;
  }

  document.getElementById('profileContent').innerHTML = `
    <div class="card"><div class="card-body">
      <div class="profile-header">
        <div class="profile-avatar">${initials}</div>
        <div class="profile-info">
          <h2>${esc(s.nombre)}</h2>
          <div class="profile-meta">
            ${s.edad ? `<span>${s.edad} años</span>` : ''}
            ${s.sexo ? `<span>${esc(s.sexo)}</span>` : ''}
            <span>Registro: ${regDate}</span>
            <span>Actualizado: ${updDate}</span>
          </div>
        </div>
        <div style="margin-left:auto;display:flex;gap:8px;">
          <button class="btn btn-secondary btn-sm" onclick="editStudent('${s.id}')">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>Editar
          </button>
          <button class="btn btn-secondary btn-sm" onclick="window.print()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14"><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect x="6" y="14" width="12" height="8"/></svg>Imprimir
          </button>
        </div>
      </div>
      <div class="profile-grid">
        <div>
          <div class="profile-section"><h4>Datos de Contacto</h4>
            <p><strong>Teléfono:</strong> ${esc(s.telefono || '—')}</p>
            <p><strong>Correo:</strong> ${esc(s.correo || '—')}</p>
            <p><strong>Dirección:</strong> ${esc(s.direccion || '—')}</p>
          </div>
          <div class="profile-section"><h4>Clases</h4>
            <p><strong>Fecha última clase:</strong> ${s.fechaUltimaClase ? new Date(s.fechaUltimaClase + 'T00:00:00').toLocaleDateString('es-ES') : '—'}</p>
            <p><strong>Duración última clase:</strong> ${esc(s.duracion || '—')}</p>
            <p><strong>Temática:</strong> ${esc(s.tematica || '—')}</p>
          </div>
          ${historialHtml}
          <div class="profile-section"><h4>Estado</h4>
            <p><strong>¿Paga bien?:</strong> <span class="badge ${payBadge}">${esc(s.pago || '—')}</span></p>
            <p style="margin-top:6px;"><strong>¿Recomendable seguir?:</strong> <span class="badge ${advBadge}">${esc(s.aconsejable || '—')}</span></p>
          </div>
        </div>
        <div>
          <div class="profile-section"><h4>Lo que sabe hacer</h4><p>${esc(s.sabe || '—')}</p></div>
          <div class="profile-section"><h4>Lo que no sabe hacer</h4><p>${esc(s.nosabe || '—')}</p></div>
          <div class="profile-section"><h4>Necesidades especiales</h4><p>${esc(s.necesidades || '—')}</p></div>
          <div class="profile-section"><h4>Personalidad</h4><p>${esc(s.personalidad || '—')}</p></div>
          <div class="profile-section"><h4>Sugerencias</h4><p>${esc(s.sugerencias || '—')}</p></div>
        </div>
      </div>
      ${s.notas ? `<div class="profile-section"><h4>Notas Adicionales</h4><p>${esc(s.notas)}</p></div>` : ''}
    </div></div>`;
  document.getElementById('viewTitle').textContent = s.nombre;
  switchView('profile');
}

// ═══════════════════════════════════════════
// EXPORT TO EXCEL (backup local)
// ═══════════════════════════════════════════
function exportToExcel() {
  if (db.length === 0) { notify('No hay datos para exportar', 'error'); return; }
  const rows = db.map(s => ({
    'Nombre completo': s.nombre || '',
    'Teléfono': s.telefono || '',
    'Correo electrónico': s.correo || '',
    'Dirección': s.direccion || '',
    'Sexo': s.sexo || '',
    'Edad': s.edad || '',
    'Fecha última clase': s.fechaUltimaClase ? new Date(s.fechaUltimaClase + 'T00:00:00').toLocaleDateString('es-ES') : '',
    'Duración última clase': s.duracion || '',
    'Nº clases': (s.historialClases || []).length,
    'Temática tratada': s.tematica || '',
    'Lo que sabe hacer': s.sabe || '',
    'Lo que no sabe hacer': s.nosabe || '',
    'Necesidades especiales': s.necesidades || '',
    'Personalidad': s.personalidad || '',
    'Sugerencias': s.sugerencias || '',
    '¿Recomendable seguir?': s.aconsejable || '',
    '¿Paga bien?': s.pago || '',
    'Notas adicionales': s.notas || '',
    'Fecha de registro': s.fechaRegistro ? new Date(s.fechaRegistro).toLocaleDateString('es-ES') : '',
    'Última actualización': s.ultimaActualizacion ? new Date(s.ultimaActualizacion).toLocaleDateString('es-ES') : ''
  }));
  const ws = XLSX.utils.json_to_sheet(rows);
  ws['!cols'] = [{wch:25},{wch:14},{wch:28},{wch:30},{wch:10},{wch:6},{wch:18},{wch:18},{wch:10},{wch:30},{wch:30},{wch:30},{wch:25},{wch:25},{wch:30},{wch:18},{wch:18},{wch:30},{wch:16},{wch:16}];
  const headerStyle = { font: { bold: true, color: { rgb: 'FFFFFF' } }, fill: { fgColor: { rgb: '2E8BC0' } }, alignment: { horizontal: 'center', vertical: 'center' } };
  const range = XLSX.utils.decode_range(ws['!ref']);
  for (let C = range.s.c; C <= range.e.c; C++) {
    const addr = XLSX.utils.encode_cell({ r: 0, c: C });
    if (ws[addr]) ws[addr].s = headerStyle;
  }
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, 'Alumnos');
  XLSX.writeFile(wb, `jam_alumnos_${new Date().toISOString().split('T')[0]}.xlsx`);
  notify('Excel exportado correctamente', 'success');
  closeSidebar();
}

// ═══════════════════════════════════════════
// STATISTICS
// ═══════════════════════════════════════════
function renderStats() {
  Object.values(chartInstances).forEach(c => c.destroy());
  chartInstances = {};
  if (db.length === 0) {
    document.getElementById('statsContent').innerHTML = `<div class="empty-state"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg><h3>Sin datos estadísticos</h3><p>Añade alumnos para ver las estadísticas.</p></div>`;
    return;
  }
  const total = db.length;
  const ages = db.filter(s => s.edad).map(s => s.edad);
  const avgAge = ages.length ? (ages.reduce((a,b) => a+b, 0) / ages.length).toFixed(1) : '—';
  const genderCount = {};
  db.forEach(s => { if(s.sexo) genderCount[s.sexo] = (genderCount[s.sexo]||0)+1; });
  let totalSessions = 0;
  const monthCount = {};
  db.forEach(s => {
    const hist = s.historialClases || [];
    totalSessions += hist.length;
    hist.forEach(h => { if (h.fecha) { const ym = h.fecha.substring(0, 7); monthCount[ym] = (monthCount[ym] || 0) + 1; } });
  });
  const durCount = {};
  db.forEach(s => { if(s.duracion) durCount[s.duracion] = (durCount[s.duracion]||0)+1; });
  const payCount = {};
  db.forEach(s => { if(s.pago) payCount[s.pago] = (payCount[s.pago]||0)+1; });
  const advCount = {};
  db.forEach(s => { if(s.aconsejable) advCount[s.aconsejable] = (advCount[s.aconsejable]||0)+1; });
  const ageRanges = {'0-12':0,'13-17':0,'18-30':0,'31-50':0,'51-65':0,'65+':0};
  ages.forEach(a => {
    if(a<=12) ageRanges['0-12']++;
    else if(a<=17) ageRanges['13-17']++;
    else if(a<=30) ageRanges['18-30']++;
    else if(a<=50) ageRanges['31-50']++;
    else if(a<=65) ageRanges['51-65']++;
    else ageRanges['65+']++;
  });
  const topicMap = {};
  db.forEach(s => {
    if (!s.tematica) return;
    s.tematica.split(/[,;\/\n]+/).forEach(t => { const clean = t.trim().toLowerCase(); if (clean) topicMap[clean] = (topicMap[clean]||0) + 1; });
  });
  const topTopics = Object.entries(topicMap).sort((a,b) => b[1]-a[1]).slice(0, 10);
  const payingCount = db.filter(s => s.pago === 'Sí').length;

  document.getElementById('statsContent').innerHTML = `
    <div class="stats-grid fade-up">
      <div class="stat-card"><div class="stat-label">Total Alumnos</div><div class="stat-value">${total}</div></div>
      <div class="stat-card"><div class="stat-label">Edad Media</div><div class="stat-value">${avgAge}</div><div class="stat-sub">${ages.length} con edad registrada</div></div>
      <div class="stat-card"><div class="stat-label">Pagan Bien</div><div class="stat-value">${payingCount}</div><div class="stat-sub">${total ? Math.round(payingCount/total*100) : 0}% del total</div></div>
      <div class="stat-card"><div class="stat-label">Temáticas</div><div class="stat-value">${Object.keys(topicMap).length}</div><div class="stat-sub">diferentes temas</div></div>
    </div>
    <div class="charts-grid fade-up">
      <div class="chart-card"><h4>Distribución por Sexo</h4><div class="chart-container"><canvas id="chartGender"></canvas></div></div>
      <div class="chart-card"><h4>Distribución por Edad</h4><div class="chart-container"><canvas id="chartAge"></canvas></div></div>
      <div class="chart-card"><h4>Clases por Mes</h4><div class="chart-container"><canvas id="chartMonths"></canvas></div></div>
      <div class="chart-card"><h4>Duración de Clase</h4><div class="chart-container"><canvas id="chartDuration"></canvas></div></div>
      <div class="chart-card"><h4>¿Paga Bien?</h4><div class="chart-container"><canvas id="chartPayment"></canvas></div></div>
      <div class="chart-card"><h4>¿Recomendable Seguir?</h4><div class="chart-container"><canvas id="chartAdvisable"></canvas></div></div>
    </div>
    ${topTopics.length > 0 ? `<div class="chart-card fade-up" style="margin-top:20px;"><h4>Temáticas Más Frecuentes</h4><ul class="topic-list">${topTopics.map(([t,c]) => `<li class="topic-item"><span>${t.charAt(0).toUpperCase()+t.slice(1)}</span><span class="topic-count">${c}</span></li>`).join('')}</ul></div>` : ''}`;

  const brandColors = ['#2E8BC0','#1B6A9C','#5CAED6','#A8D8EA','#0D4F6E','#3DA1D2'];
  const statusColors = { 'Sí':'#2a9d6a','No':'#d94452','A veces':'#e8a820','En evaluación':'#e8a820','Se lo hago gratis':'#2E8BC0' };

  if (Object.keys(genderCount).length) chartInstances.gender = new Chart(document.getElementById('chartGender'), { type:'doughnut', data:{labels:Object.keys(genderCount),datasets:[{data:Object.values(genderCount),backgroundColor:brandColors}]}, options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'bottom',labels:{font:{family:'DM Sans'}}}}} });
  if (ages.length) chartInstances.age = new Chart(document.getElementById('chartAge'), { type:'bar', data:{labels:Object.keys(ageRanges),datasets:[{label:'Alumnos',data:Object.values(ageRanges),backgroundColor:'#2E8BC0',borderRadius:6}]}, options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false}},scales:{y:{beginAtZero:true,ticks:{stepSize:1}},x:{ticks:{font:{family:'DM Sans'}}}}} });
  const sortedMonths = Object.keys(monthCount).sort();
  if (sortedMonths.length) chartInstances.months = new Chart(document.getElementById('chartMonths'), { type:'bar', data:{labels:sortedMonths.map(m => { const [y,mo]=m.split('-'); return ['Ene','Feb','Mar','Abr','May','Jun','Jul','Ago','Sep','Oct','Nov','Dic'][parseInt(mo)-1]+' '+y; }),datasets:[{label:'Clases',data:sortedMonths.map(m=>monthCount[m]),backgroundColor:'#5CAED6',borderRadius:6}]}, options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false}},scales:{y:{beginAtZero:true,ticks:{stepSize:1}},x:{ticks:{font:{family:'DM Sans'}}}}} });
  if (Object.keys(durCount).length) chartInstances.duration = new Chart(document.getElementById('chartDuration'), { type:'doughnut', data:{labels:Object.keys(durCount),datasets:[{data:Object.values(durCount),backgroundColor:brandColors}]}, options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'bottom',labels:{font:{family:'DM Sans'}}}}} });
  if (Object.keys(payCount).length) chartInstances.payment = new Chart(document.getElementById('chartPayment'), { type:'doughnut', data:{labels:Object.keys(payCount),datasets:[{data:Object.values(payCount),backgroundColor:Object.keys(payCount).map(k=>statusColors[k]||'#999')}]}, options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'bottom',labels:{font:{family:'DM Sans'}}}}} });
  if (Object.keys(advCount).length) chartInstances.advisable = new Chart(document.getElementById('chartAdvisable'), { type:'doughnut', data:{labels:Object.keys(advCount),datasets:[{data:Object.values(advCount),backgroundColor:Object.keys(advCount).map(k=>statusColors[k]||'#999')}]}, options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'bottom',labels:{font:{family:'DM Sans'}}}}} });
}

// ═══════════════════════════════════════════
// INIT — carga automática al arrancar
// ═══════════════════════════════════════════
const LOGO_SRC = "data:image/jpeg;base64,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";

document.getElementById('logoImg').src = LOGO_SRC;
document.getElementById('printLogo').src = LOGO_SRC;

// Arranque: cargar datos locales primero, luego sincronizar con GitHub
loadDB();
renderStudents();

// Auto-pull al iniciar si GitHub está configurado
(async () => {
  if (isGitHubConfigured()) {
    setSyncStatus('syncing', 'Cargando datos...');
    await pullFromGitHub(true);
  } else {
    setSyncStatus('offline', 'Sin configurar');
  }
})();
</script>
</body>
</html>
